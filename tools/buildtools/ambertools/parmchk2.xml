<tool id="parmchk2" name="ParmChk2" version="1.0">
    <description>Amber Parameter Checker</description>
    <requirements>
        <requirement type="package" version="19.0">ambertools</requirement>
        <requirement type="package" version="3.0.0">libgfortran</requirement>
    </requirements>
    <command detect_errors="exit_code">
        <![CDATA[
        parmchk2 -i $input1 -f $input_format.selected_format  -o $output1 -s $allparams.s -a $allparams.a
        ]]>
    </command>
    <inputs>
      <conditional name="input_format">
            <param name="selected_format" type="select" label="Select a file format:">
                <option value="mol2">mol2</option>
            </param>
            <when value="mol2">
              <param type="data" name="input1" format="mol2" />
            </when>
      </conditional>
        <param name="selected_output_format" type="select" label="Select an output file format (txt recommended!):">
            <option value="txt" selected="true">txt</option>
        </param>
        <section name="allparams" title="General Parameters" expanded="true">
            <param name="s" type="integer" value="2" label="ffparm set parameter (suppressed by -p option), 1: gaff 2: gaff2" min="1" max="2"/>
            <param name="a" type="select" label="print out all force field parameters including those in the parm file default is no">
             <option value="y">Yes</option>
             <option selected="True" value="n">No</option>
        </param>
        </section>
    </inputs>
    <outputs>
        <data format="txt" name="output1" label="${tool.name}: structure output">
        <change_format>
            <when input="selected_output_format" value="txt" format="txt"/>
            <!-- <when input="selected_format" value="xyz" format="xyz"/>
            <when input="selected_format" value="tinker" format="tinker"/>
            <when input="selected_format" value="moldy" format="moldy"/> -->
        </change_format>
        </data>
    </outputs>
    <help><![CDATA[
.. class:: infomark

**What it does**

Antechamber parameter check
parmchk2 reads in an mol2 file (along with default atomtype similarity index file iand forcefield files (the default is $AMBERHOME/dat/antechamber/PARMCHK.DAT & $AMBERHOME/dat/leap/parm/gaff.dat). 
It writes out a force field modification (frcmod) file containing any force field parameters that are needed for the molecule but not supplied by the force field file. 
Problematic parameters, if any, are indicated in the frcmod file with the note, “ATTN, need revision”, and are typically given values of zero.


.. class:: infomark

**How it works**

- Select a mol input file (mol2)
- Specify the correct unknown parameter

.. class:: infomark

**Outputs created**

- Outputs a frcmod file as text

.. class:: infomark

**User guide and documentation**

- AmberTools `userguide`_


.. _`userguide`: http://ambermd.org/doc12/Amber19.pdf

.. class:: infomark

**Feature requests**

Go to Galaxy Computational Chemistry and make a `feature request`_

.. _`feature request`: https://github.com/galaxycomputationalchemistry/galaxy-tools-compchem/issues/new

]]>
    </help>
    <citations>
	    <citation type="doi">10.1002/jcc.20290</citation>
	            <citation type="bibtex">
@misc{ambertools,
  author = {D.A. Case, I.Y. Ben-Shalom, S.R. Brozell, D.S. Cerutti, T.E. Cheatham, III, V.W.D. Cruzeiro, T.A. Darden, R.E. Duke, D. Ghoreishi, M.K. Gilson, H. Gohlke, A.W. Goetz, D. Greene, R Harris, N. Homeyer, S. Izadi, A. Kovalenko, T. Kurtzman, T.S. Lee, S. LeGrand, P. Li, C. Lin, J. Liu, T. Luchko, R. Luo, D.J. Mermelstein, K.M. Merz, Y. Miao, G. Monard, C. Nguyen, H. Nguyen, I. Omelyan, A. Onufriev, F. Pan, R. Qi, D.R. Roe, A. Roitberg, C. Sagui, S. Schott-Verdugo, J. Shen, C.L. Simmerling, J. Smith, R. Salomon-Ferrer, J. Swails, R.C. Walker, J. Wang, H. Wei, R.M. Wolf, X. Wu, L. Xiao, D.M. York and P.A. Kollman },
  year = {2018},
  title = {AMBER 2018},
  publisher = {University of California, San Francisco},
  url = {http://ambermd.org/CiteAmber.php},
}</citation>
    </citations>
</tool>
